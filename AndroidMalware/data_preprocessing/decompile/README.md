This *opcodeseq_creator* comes from the open source code for the paper [Deep Android Malware Detection](http://dl.acm.org/citation.cfm?id=3029823). The converting codes come from the open source code for the paper [Evaluating Explanation Methods for Deep Learning in Security](https://www.sec.cs.tu-bs.de/pubs/2020-eurosp.pdf).

## Steps to run the script:

1. Install apktool. You can find the installation guidance in [https://apktool.org/docs/install](https://apktool.org/docs/install).

2. Decomplie the apk files into the dalvik opcode sequences. If you want to run a test, there are 3 benign apks in `./testdata/apk`, and you can simply run the following command:

```bash
$ cd testdata
$ mkdir tmp opseq
$ python3 ./run_opcode_seq_creation.py ./apk ./tmp ./opseq incl
$ cd ..
```

- A prepared decompiled dalvik opcode dataset `../../data/Opcodes_all.zip` ([Contagio Dataset](http://contagiominidump.blogspot.com)) can be unzipped directly for test. The zip file comes from [https://github.com/alewarne/explain-mlsec/tree/master/NetworkTraining/DAMD](https://github.com/alewarne/explain-mlsec/tree/master/NetworkTraining/DAMD).

- You can creat your own apk data folders and update the path in the file `./config_preprocessing.py`.

- For more details, please refer to the original github repo: [https://github.com/niallmcl/Deep-Android-Malware-Detection/tree/master/opcodeseq_creator](https://github.com/niallmcl/Deep-Android-Malware-Detection/tree/master/opcodeseq_creator).

3. Convert the dalvik opcode sequences into files of sequences of token indices. If you want to run a test, you can simply run the following command:

```bash
$ python3 preprocessing.py
```

- If you want to convert your own apks into new folders, please remember to update the path in the file `./config_preprocessing.py`.

- For more details, please refer to the original github repo: [https://github.com/alewarne/explain-mlsec/tree/master/NetworkTraining/DAMD](https://github.com/alewarne/explain-mlsec/tree/master/NetworkTraining/DAMD).


